<!doctype html><html><head><link rel=stylesheet href=https://hybrid-cloud-patterns.io/sass/patternfly.css><link rel=stylesheet href=https://hybrid-cloud-patterns.io/sass/patternfly-addons.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.2/css/solid.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.7.2/css/fontawesome.css><link rel=stylesheet href=/css/custom.css><title>Cluster Sizing | Hybrid Cloud Patterns</title></head><body><div class=pf-c-page><header class=pf-c-page__header><div class=pf-c-page__header-brand><a href=/ class=pf-c-page__header-brand-link><img src=/images/hybrid_cloud_patterns.png alt="Hybrid Cloud Patterns"></a></div><div class=pf-c-page__header-tools><nav class="pf-c-nav pf-m-horizontal" role=navigation><ul class=pf-c-nav__list><li class="pf-c-nav__item pf-m-current"><a class=pf-c-nav__link href=/patterns/ title=Patterns>Patterns</a></li><li class=pf-c-nav__item><a class=pf-c-nav__link href=/learn/ title=Learn>Learn</a></li><li class=pf-c-nav__item><a class=pf-c-nav__link href=/contribute/ title=Contribute>Contribute</a></li><li class=pf-c-nav__item><a class=pf-c-nav__link href=/blog/ title=Blog>Blog</a></li></ul></nav></div></header><div class=pf-c-page__sidebar><div class=pf-c-page__sidebar-body><div class=pf-c-nav><ul class=pf-c-nav__list><li class=pf-c-nav__item><a href=/patterns/ class=pf-c-nav__link><span class="pf-c-icon pf-m-md pf-m-inline"><span class=pf-c-icon__content><i class="fas fa-angle-left" aria-hidden=true></i></span></span>
<span style=padding-left:10px>Back to Patterns</span></a></li><li class="pf-c-nav__item pf-m-expanded"><a href=https://hybrid-cloud-patterns.io/patterns/ansible-edge-gitops/ class=pf-c-nav__link>Ansible Edge GitOps</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=https://hybrid-cloud-patterns.io/patterns/ansible-edge-gitops/getting-started/ class=pf-c-nav__link>Getting Started</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=https://hybrid-cloud-patterns.io/patterns/ansible-edge-gitops/installation-details/ class=pf-c-nav__link>Installation Details</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=https://hybrid-cloud-patterns.io/patterns/ansible-edge-gitops/cluster-sizing/ class="pf-c-nav__link pf-m-current">Cluster Sizing</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=https://hybrid-cloud-patterns.io/patterns/ansible-edge-gitops/ansible-automation-platform/ class=pf-c-nav__link>Ansible Automation Platform</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=https://hybrid-cloud-patterns.io/patterns/ansible-edge-gitops/openshift-virtualization/ class=pf-c-nav__link>OpenShift Virtualization</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=https://hybrid-cloud-patterns.io/patterns/ansible-edge-gitops/ideas-for-customization/ class=pf-c-nav__link>Ideas for Customization</a></li><li class="pf-c-nav__item pf-m-expanded"><a href=https://hybrid-cloud-patterns.io/patterns/ansible-edge-gitops/troubleshooting/ class=pf-c-nav__link>Troubleshooting</a></li></ul></div></div></div><main class=pf-c-page__main><section class=pf-c-page__main-section><div class="pf-l-grid pf-m-gutter"><div class="pf-l-grid__item pf-m-8-col"><div class=pf-c-content><div class=pf-c-content><h1 id=openshift-cluster-sizing-for-the-ansible-edge-gitops-pattern>OpenShift Cluster Sizing for the Ansible Edge GitOps Pattern</h1><h2 id=tested-platforms>Tested Platforms</h2><p>The <strong>Ansible Edge GitOps</strong> pattern has been tested on AWS:</p><table><thead><tr><th style=text-align:left><strong>Certified Cloud Providers</strong></th><th style=text-align:left>4.9</th><th style=text-align:left>4.10</th></tr></thead><tbody><tr><td style=text-align:left>Amazon Web Services</td><td style=text-align:left></td><td style=text-align:left>Tested</td></tr></tbody></table><p>The pattern is adaptable to running on bare metal/on-prem clusters but has not yet been tested there.</p><h2 id=general-openshift-minimum-requirements>General OpenShift Minimum Requirements</h2><p>OpenShift 4 has the following minimum requirements for sizing of nodes:</p><ul><li><strong>Minimum 4 vCPU</strong> (additional are strongly recommended).</li><li><strong>Minimum 16 GB RAM</strong> (additional memory is strongly recommended, especially if etcd is colocated on Control Planes).</li><li><strong>Minimum 40 GB</strong> hard disk space for the file system containing /var/.</li><li><strong>Minimum 1 GB</strong> hard disk space for the file system containing /usr/local/bin/.</li></ul><p>There is one application that comprises the <strong>Ansible Edge GitOps</strong> pattern. In addition, the <strong>Ansible Edge GitOps</strong> pattern also includes the Advanced Cluster Management (ACM) supporting operator that is installed by <strong>OpenShift GitOps</strong> using ArgoCD.</p><h3 id=ansible-edge-gitops-pattern-components><strong>Ansible Edge GitOps</strong> Pattern Components</h3><p>Here&rsquo;s an inventory of what gets deployed by the <strong>Ansible Edge GitOps</strong> pattern on the Datacenter/Hub OpenShift cluster:</p><table><thead><tr><th style=text-align:left>Name</th><th style=text-align:left>Kind</th><th style=text-align:left>Namespace</th><th style=text-align:left>Description</th></tr></thead><tbody><tr><td style=text-align:left>Ansible Edge GitOps-hub</td><td style=text-align:left>Application</td><td style=text-align:left>Ansible Edge GitOps-hub</td><td style=text-align:left>Hub GitOps management</td></tr><tr><td style=text-align:left>Red Hat OpenShift GitOps</td><td style=text-align:left>Operator</td><td style=text-align:left>openshift-operators</td><td style=text-align:left>OpenShift GitOps</td></tr><tr><td style=text-align:left>Red Hat Ansible Automation Platform</td><td style=text-align:left>Operator</td><td style=text-align:left>ansible-automation-platform</td><td style=text-align:left>Ansible Automation</td></tr><tr><td style=text-align:left>Red Hat OpenShift Data Foundations</td><td style=text-align:left>Operator</td><td style=text-align:left>openshift-storage</td><td style=text-align:left>OpenShift Storage solution</td></tr><tr><td style=text-align:left>Red Hat OpenShift Virtualization</td><td style=text-align:left>Operator</td><td style=text-align:left>openshift-cnv</td><td style=text-align:left>Virtualization software to run VMs</td></tr><tr><td style=text-align:left>Edge GitOps VMs</td><td style=text-align:left>VMs</td><td style=text-align:left>edge-gitops-vms</td><td style=text-align:left>Simulated Edge environment with VMs to manage</td></tr><tr><td style=text-align:left>Hashicorp Vault</td><td style=text-align:left>Operator</td><td style=text-align:left>vault</td><td style=text-align:left>Secrets Storage</td></tr><tr><td style=text-align:left>External Secrets Operator (ESO)</td><td style=text-align:left>Operator</td><td style=text-align:left>golang-external-secrets</td><td style=text-align:left>Abstraction for secrets storage</td></tr></tbody></table><h3 id=ansible-edge-gitops-pattern-openshift-datacenter-hub-cluster-size>Ansible Edge GitOps Pattern OpenShift Datacenter HUB Cluster Size</h3><p>The Ansible Edge GitOps pattern has been tested with a defined set of specifically tested configurations that represent the most common combinations that Red Hat OpenShift Container Platform (OCP) customers are using or deploying for the x86_64 architecture.</p><p>The Hub OpenShift Cluster is made up of the the following on the AWS deployment tested:</p><table><thead><tr><th style=text-align:left>Node Type</th><th style=text-align:center>Number of nodes</th><th style=text-align:left>Cloud Provider</th><th style=text-align:left>Instance Type</th></tr></thead><tbody><tr><td style=text-align:left>Control Plane</td><td style=text-align:center>3</td><td style=text-align:left>Amazon Web Services</td><td style=text-align:left>m5.xlarge</td></tr><tr><td style=text-align:left>Worker</td><td style=text-align:center>3</td><td style=text-align:left>Amazon Web Services</td><td style=text-align:left>m5.4xlarge</td></tr><tr><td style=text-align:left>Worker</td><td style=text-align:center>1</td><td style=text-align:left>Amazon Web Services</td><td style=text-align:left>c5n.metal</td></tr></tbody></table><p>The metal node is added to the cluster by the installation process after initial provisioning. The pattern on the hub requires OpenShift Data Fabric to support Virtual Machine storage and is a <strong>minimum</strong> size for a Hub cluster. In the next few sections we take some snapshots of the cluster utilization while the <strong>Ansible Edge GitOps</strong> pattern is running. Keep in mind that resources will have to be added as more developers are working building their applications.</p><h4 id=datacenter-cluster-utilization>Datacenter Cluster utilization</h4><p>Below is a snapshot of the OpenShift cluster utilization while running the <strong>Ansible Edge GitOps</strong> pattern:</p><table><thead><tr><th style=text-align:center>CPU</th><th style=text-align:center>CPU%</th><th style=text-align:center>Memory</th><th style=text-align:center>Memory%</th></tr></thead><tbody><tr><td style=text-align:center>321m</td><td style=text-align:center>0%</td><td style=text-align:center>12511Mi</td><td style=text-align:center>6%</td></tr><tr><td style=text-align:center>736m</td><td style=text-align:center>21%</td><td style=text-align:center>7533Mi</td><td style=text-align:center>51%</td></tr><tr><td style=text-align:center>673m</td><td style=text-align:center>4%</td><td style=text-align:center>9298Mi</td><td style=text-align:center>14%</td></tr><tr><td style=text-align:center>920m</td><td style=text-align:center>26%</td><td style=text-align:center>8635Mi</td><td style=text-align:center>59%</td></tr><tr><td style=text-align:center>673m</td><td style=text-align:center>4%</td><td style=text-align:center>9258Mi</td><td style=text-align:center>14%</td></tr><tr><td style=text-align:center>921m</td><td style=text-align:center>26%</td><td style=text-align:center>9407Mi</td><td style=text-align:center>65%</td></tr><tr><td style=text-align:center>395m</td><td style=text-align:center>2%</td><td style=text-align:center>5149Mi</td><td style=text-align:center>8%</td></tr></tbody></table><h3 id=aws-instance-types>AWS Instance Types</h3><p>The <strong>Ansible Edge GitOps</strong> pattern was tested with the highlighted AWS instances in <strong>bold</strong>. The OpenShift installer will let you know if the instance type meets the minimum requirements for a cluster.</p><p>The message that the openshift installer will give you will be similar to this message</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>INFO Credentials loaded from default AWS environment variables
</span></span><span style=display:flex><span>FATAL failed to fetch Metadata: failed to load asset &#34;Install Config&#34;: [controlPlane.platform.aws.type: Invalid value: &#34;m4.large&#34;: instance type does not meet minimum resource requirements of 4 vCPUs, controlPlane.platform.aws.type: Invalid value: &#34;m4.large&#34;: instance type does not meet minimum resource requirements of 16384 MiB Memory]
</span></span></code></pre></div><p>Below you can find a list of the AWS instance types that can be used to deploy the <strong>Ansible Edge GitOps</strong> pattern.</p><table><thead><tr><th style=text-align:center>Instance type</th><th style=text-align:center>Default vCPUs</th><th style=text-align:center>Memory (GiB)</th><th style=text-align:center>Datacenter</th><th style=text-align:center>Factory/Edge</th></tr></thead><tbody><tr><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center></td><td style=text-align:center>3x3 OCP Cluster</td><td style=text-align:center>3 Node OCP Cluster</td></tr><tr><td style=text-align:center>m4.xlarge</td><td style=text-align:center>4</td><td style=text-align:center>16</td><td style=text-align:center>N</td><td style=text-align:center>N</td></tr><tr><td style=text-align:center>m4.2xlarge</td><td style=text-align:center>8</td><td style=text-align:center>32</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center>m4.4xlarge</td><td style=text-align:center>16</td><td style=text-align:center>64</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center>m4.10xlarge</td><td style=text-align:center>40</td><td style=text-align:center>160</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center>m4.16xlarge</td><td style=text-align:center>64</td><td style=text-align:center>256</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center>m5.xlarge</td><td style=text-align:center>4</td><td style=text-align:center>16</td><td style=text-align:center>Y</td><td style=text-align:center>N</td></tr><tr><td style=text-align:center>m5.2xlarge</td><td style=text-align:center>8</td><td style=text-align:center>32</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center><strong>m5.4xlarge</strong></td><td style=text-align:center>16</td><td style=text-align:center>64</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center>m5.8xlarge</td><td style=text-align:center>32</td><td style=text-align:center>128</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center>m5.12xlarge</td><td style=text-align:center>48</td><td style=text-align:center>192</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center>m5.16xlarge</td><td style=text-align:center>64</td><td style=text-align:center>256</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr><tr><td style=text-align:center>m5.24xlarge</td><td style=text-align:center>96</td><td style=text-align:center>384</td><td style=text-align:center>Y</td><td style=text-align:center>Y</td></tr></tbody></table><p>The OpenShift cluster is made of 3 Control Plane nodes and 4 Workers for the Hub cluster; 3 workers are standard compute nodes and one is c5n.metal. For the node sizes we used the <strong>m5.4xlarge</strong> on AWS and this instance type met the minimum requirements to deploy the <strong>Ansible Edge GitOps</strong> pattern successfully on the Hub cluster.</p><p>This pattern is currently only usable on AWS because of the integration of OpenShift Virtualization; it would be straightforward to adapt this pattern also to run on bare metal/on-prem clusters. If and when other public cloud providers support metal node provisioning in OpenShift Virtualization, we will document that here.</p></div></div></div><div class="pf-l-grid__item pf-m-4-col"><nav class="pf-c-jump-links pf-m-vertical" aria-label=Contents><div class=pf-c-jump-links__main><div class=pf-c-jump-links__header><div class=pf-c-jump-links__label><h1>Table of Contents</h1></div></div><nav id=TableOfContents><ul class=pf-c-jump-links__list><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#openshift-cluster-sizing-for-the-ansible-edge-gitops-pattern>OpenShift Cluster Sizing for the Ansible Edge GitOps Pattern</a><ul class=pf-c-jump-links__list><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#tested-platforms>Tested Platforms</a></li><li class=pf-c-jump-links__item><a class=pf-c-jump-links__link href=#general-openshift-minimum-requirements>General OpenShift Minimum Requirements</a></li></ul></li></ul></nav></div></nav></div></div></section></main></div><div><div style=padding:10px;text-align:center;color:#d2d2d2;background-color:#000>Copyright &copy; 2022 Red Hat, Inc.</div></div></body></html>